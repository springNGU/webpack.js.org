(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{379:function(n,s,a){"use strict";a.r(s),s.default='<p><code>publicPath</code> 配置选项在各种场景中都非常有用。你可以通过它来指定应用程序中所有资源的基础路径。</p>\n<h2 id="示例">示例<a href="#%E7%A4%BA%E4%BE%8B" aria-hidden="true"><span class="icon icon-link"></span></a></h2>\n<p>下面提供一些用于实际应用程序的示例，通过这些示例，此功能显得极其简单。实质上，发送到 <code>output.path</code> 目录的每个文件，都将从 <code>output.publicPath</code> 位置引用。这也包括（通过 <a href="/guides/code-splitting/">代码分离</a> 创建的）子 chunk 和作为依赖图一部分的所有其他资源（例如 image, font 等）。</p>\n<h3 id="基于环境设置">基于环境设置<a href="#%E5%9F%BA%E4%BA%8E%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE" aria-hidden="true"><span class="icon icon-link"></span></a></h3>\n<p>在开发环境中，我们通常有一个 <code>assets/</code> 文件夹，它与索引页面位于同一级别。这没太大问题，但是，如果我们将所有静态资源托管至 CDN，然后想在生产环境中使用呢？</p>\n<p>想要解决这个问题，可以直接使用一个有着悠久历史的 environment variable(环境变量)。假设我们有一个变量 <code>ASSET_PATH</code>：</p>\n<pre><code class="hljs language-js"><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">\'webpack\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 尝试使用环境变量，否则使用根路径</span>\n<span class="token keyword">const</span> <span class="token constant">ASSET_PATH</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_PATH</span> <span class="token operator">||</span> <span class="token string">\'/\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>\n  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n    publicPath<span class="token punctuation">:</span> <span class="token constant">ASSET_PATH</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">// 这可以帮助我们在代码中安全地使用环境变量</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      <span class="token string">\'process.env.ASSET_PATH\'</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">ASSET_PATH</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>\n<h3 id="在运行时设置">在运行时设置<a href="#%E5%9C%A8%E8%BF%90%E8%A1%8C%E6%97%B6%E8%AE%BE%E7%BD%AE" aria-hidden="true"><span class="icon icon-link"></span></a></h3>\n<p>另一个可能出现的情况是，需要在运行时设置 <code>publicPath</code>。webpack 暴露了一个名为 <code>__webpack_public_path__</code> 的全局变量。所以在应用程序的 entry point 中，可以直接如下设置：</p>\n<pre><code class="hljs language-js">__webpack_public_path__ <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_PATH</span><span class="token punctuation">;</span></code></pre>\n<p>这些内容就是你所需要的。由于我们已经在配置中使用了 <code>DefinePlugin</code>，\n<code>process.env.ASSET_PATH</code> 将始终都被定义，\n因此我们可以安全地使用。</p>\n<blockquote class="warning">\n<p>注意，如果在 entry 文件中使用 ES2015 module import，则会在 import 之后进行 <code>__webpack_public_path__</code> 赋值。在这种情况下，你必须将 public path 赋值移至一个专用模块中，然后将它的 import 语句放置到 entry.js 最上面：</p>\n</blockquote>\n<pre><code class="hljs language-js"><span class="token comment">// entry.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./public-path\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token string">\'./app\'</span><span class="token punctuation">;</span></code></pre>\n'}}]);